<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì‹¤ìŠµë¬¸ì œ 1</title>

    <!-- axios CDN -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  </head>
  <body>
    <h1>ì‹¤ìŠµë¬¸ì œ1</h1>
    <form name="person">
      <label for="name">
        ì´ë¦„ <input type="text" name="name" id="name" />
      </label>
      <br />
      <fieldset>
        <legend>ì„±ë³„</legend>
        <label for="man"
          ><input type="radio" name="gender" id="man" value="ë‚¨ì" />
          ë‚¨ì</label
        >
        <label for="woman"
          ><input type="radio" name="gender" id="woman" value="ì—¬ì" />
          ì—¬ì</label
        >
      </fieldset>

      <br />
      <fieldset>
        <legend>ìƒë…„ì›”ì¼</legend>

        <select id="year" name="year">
          <option value="">ì„ íƒ</option></select
        ><label for="year">ë…„</label>

        <select id="month" name="month">
          <option value="">ì„ íƒ</option></select
        ><label for="month">ì›”</label>

        <select id="day" name="day">
          <option value="">ì„ íƒ</option></select
        ><label for="day">ì¼</label>
      </fieldset>

      <br />
      <fieldset>
        <legend>ê´€ì‹¬ì‚¬</legend>
        <label><input type="checkbox" name="like" value="ì—¬í–‰" />ì—¬í–‰</label>
        <label><input type="checkbox" name="like" value="íŒ¨ì…˜" />íŒ¨ì…˜</label>
        <label> <input type="checkbox" name="like" value="ìŒì‹" />ìŒì‹</label>
      </fieldset>
      <br />
      <button type="button" onclick="AxiosGet()">ì œì¶œ(axios GET)</button>
    </form>

    <div class="result"></div>

    <script>
      const selecYear = document.getElementById("year");
      //   console.log(selecYear)
      const currentY = new Date().getFullYear();
      for (let year = 1990; year <= currentY; year++) {
        const option = document.createElement("option");
        option.value = year;
        option.textContent = year;
        selecYear.append(option);
      }

      const selecMonth = document.getElementById("month");
      for (let month = 1; month <= 12; month++) {
        const option = document.createElement("option");
        option.value = month;
        option.textContent = month;
        selecMonth.append(option);
      }

      const selecDay = document.getElementById("day");
      for (let day = 1; day <= 31; day++) {
        const option = document.createElement("option");
        option.value = day;
        option.textContent = day;
        selecDay.append(option);
      }

      /* ì‹¤ìŠµ ì¶”ê°€ */
      const form = document.forms["person"];
      const resultDiv = document.querySelector(".result");

      function AxiosGet() {
        // console.log("click")
        // GET /axios-practice1
        const likesValue = [];
        form.like.forEach((input) => {
          if (input.checked) likesValue.push(input.value);
        });

        const data = {
          name: form.name.value,
          gender: form.gender.value,
          like: likesValue,
        };
        axios({
          method: "get",
          url: "/axios-practice1",
          params: data,
        }).then((response) => {
          console.log(response.data);
          const { name, like } = response.data; // response.dataëŠ” ê°ì²´
          resultDiv.textContent = `${name}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤! ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!
          ì·¨ë¯¸ëŠ” ${like} ì´ë„¤ìš”`;
        });
      }

      /* async ë¡œ í•˜ëŠ” ë°©ë²•
      async function AxiosGet() {
        const fav = [];
        for (let fa of form.like) {
          // console.log(fa.checked);
          // console.log(fa.value);

          // fa(input check) ì¤‘ì— fav.checked ê°€ trueë¼ë©´
          // ë¹ˆ ë°°ì—´ favì— fav.value ì¶”ê°€ (fav.push)
          if (fa.checked === true) {
            fav.push(fa.value);
          }
        }
        // ìµœì¢…ì ìœ¼ë¡œ ì„œë²„ì— ë³´ë‚´ì¤„ ë°ì´í„°ëŠ” fav

        const data = {
          name: form.name.value,
          // like: form.like.value, // ë¹ˆ ê°’
          like: fav,
        };

        try {
          const response = await axios({
            method: "get",
            url: `/axios?name=${data.name}&like=${data.like}`,
          });
          console.log(response.data.like);
          const { name, like } = response.data;
          resultDiv.textContent = `${name}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤! ê°€ì…ì´ ì™„ë£Œ ë˜ì—ˆìŠµë‹ˆë‹¤!ğŸ‰ ì·¨ë¯¸ëŠ” ${fav}ì´ë„¤ìš”!`;
        } catch (err) {
          console.error(err);
        }
      }*/
    </script>
  </body>
</html>
